## Яндекс Практикум, курс "Инженер Машинного Обучения" (2024 г.)
## Проект 2-го спринта: "Улучшение baseline-модели"
### *Выполнил: Кирилл Н., email: ibnkir@yandex.ru, бакет в S3: s3-student-mle-20240227-804436ded9*

### Краткое описание
Целью проекта является практическое освоение MLflow для мониторинга процесса обучения, логирования параметров, метрик, моделей и других артефактов, а также использование различных инструментов для улучшения моделей, включая генерацию и отбор признаков, подбор гипер-параметров. В качестве бейзлайна используется модель предсказания цен на квартиры из проекта 1-го спринта.

Основные инструменты: sklearn, catboost, MLflow, Autofeat, mlxtend, Optuna, 

### Установка
В терминале перейти в папку, которая будет содержать папку проекта, и выполнить следующую последовательность команд:

git clone https://github.com/ibnkir/mle-project-sprint-2

cd ./mle-project-sprint-2

pip install -r requirements.txt

### Руководство по проекту
#### Этап 1: Развертывание MLflow и регистрация модели
Шаги:
- В терминале сделать текущей папку проекта и выполнить команду: sh run_mlflow_server.sh
- Выполнить код в ноутбуке ./mlflow_server/notebook_step_1.ipynb для подготовки модели, расчета метрик и их последующего логирования

Результаты в MLflow:
- Имя эксперимента: 'mle-project-sprint-2'
- Имя запуска: 'step_1'
- ID запуска: '64fa92a4b2f848018acec0bfa7435f1f'
- Имя модели: 'flats_price_model_sprint_2_step_1' (сохранена в папке 'models')

#### Этап 2: Проведение EDA 
Шаги:
- Выполнить код в ноутбуке ./mlflow_improvement/notebook_eda.ipynb со всеми шагами EDA
- Выполнить код в ноутбуке ./mlflow_improvement/notebook_steps_2_5.ipynb в разделе 2-го этапа для логирования результатов EDA, включая файлы notebook_eda.ipynb и conclusions_eda.md
(в последнем собраны выводы по результатам EDA).

Результаты в MLflow:
- Имя эксперимента: 'mle-project-sprint-2'
- Имя запуска: 'step_2'
- ID запуска: ''
- Ноутбук и md-файл с выводами сохранены в папке 'artifacts'

#### Этап 3: Генерация признаков и обучение модели
Шаги:
- Выполнить код в ноутбуке ./mlflow_improvement/notebook_steps_2_5.ipynb в разделе 3-го этапа.

Были сгенерированы новые числовые признаки с помощью PolynomialFeatures, KBinsDiscretizer и AutoFeatRegressor (трансформации автогенератора: 'exp', 'log', 'abs', 'sqrt', '^2', '^3', '1/').
По сравнению с базовой моделью из 1-го этапа средняя ошибка MAPE на кросс-валидации уменьшилась с до . При этом увеличилось время обучения. 

Результаты в MLflow:
- Имя эксперимента: 'mle-project-sprint-2'
- Имя запуска: 'step_3'
- ID запуска: ''
- Имя модели: 'flats_price_model_sprint_2_step_3' (сохранена в папке 'models')
- Имя автогенератора признаков: 'AutoFeatRegressor' (сохранена в папке 'models')

#### Этап 4: Отбор признаков и обучение новой версии модели
Шаги:
- Выполнить код в ноутбуке ./mlflow_improvement/notebook_steps_2_5.ipynb в разделе 3-го этапа.

С помощью методов Sequential Backward Selection и Sequential Forward Selection были отобраны признаки в трансформированных данных, полученных на предыдущем этапе.
Новая модель была обучена на объединении этих признаков. Средняя ошибка MAPE на кросс-валидации уменьшилась с до. Время обучения

Результаты в MLflow:
- Имя эксперимента: 'mle-project-sprint-2'
- Имя запуска: 'step_4'
- ID запуска: ''
- Имя модели: 'flats_price_model_sprint_2_step_4'
- Графики и таблицы сохранены в папке 'fs_assets'

#### Этап 5: Подбор гиперпараметров и обучение новой версии модели
Опишите использованные методы подбора гиперпараметров, дайте оценку их влияния на результаты модели. Добавьте названия соответствующих запусков в MLflow. 

Результаты в MLflow:
- Имя эксперимента: 'mle-project-sprint-2'
- Имя запуска: 'step_4'
- ID запуска: ''
- Имя модели: 'flats_price_model_sprint_2_step_4'

