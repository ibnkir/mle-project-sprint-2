## Яндекс Практикум, курс "Инженер Машинного Обучения" (2024 г.)
## Проект 2-го спринта: "Улучшение baseline-модели"
### *Выполнил: Кирилл Н., email: ibnkir@yandex.ru, бакет в S3: s3-student-mle-20240227-804436ded9*

### Краткое описание
Целью проекта является практическое освоение MLflow для мониторинга процесса обучения, логирования параметров, метрик, моделей и других артефактов, а также использование различных инструментов для улучшения моделей, включая генерацию признаков и подбор гипер-параметров. В качестве бейзлайна используется модель предсказания цен на квартиры из проекта 1-го спринта.

Основные инструменты:
- MLflow,
- Autofeat, Featuretools - библиотеки для генерации признаков,
- mlxtend - библиотека для отбора признаков,
- Optuna для байевской оптимизации поиска гипер-параметров.

### Установка
git clone https://github.com/ibnkir/mle-project-sprint-2

cd ./mle-project-sprint-2

pip install -r requirements.txt

### Руководство по проекту
#### Этап 1: Развертывание MLflow и регистрация модели
Шаги:
- Выполнить скрипт из командной строки:
cd ./mlflow_server

sh run_mlflow_server
- Выполнить код в ноутбуке notebook_step_1.ipynb

Результаты в MLflow:
- EXPERIMENT_NAME = 'mle-project-sprint-2',
- RUN_NAME = 'step_1',
- RUN_ID = 
- REGISTRY_MODEL_NAME = 'flats_model_sprint_2_step_1'


#### Этап 2: Проведение EDA 
Шаги EDA:
- Загружаем данные из таблиц flats и buildings;
- Переименовываем id на flat_id, чтобы не путать его с автоматически создаваемой индексной колонкой БД;
- Удаляем строки с пустыми/одинаковыми flat_id и пустыми/нулевыми/отрицательными ценами;
- Удаляем строки с одинаковыми признаками;
- Заполняем пропуски в признаках (для вещественных используем среднее значение, для остальных - моду);
- Удаляем выбросы у целых и вещественных признаков;
- Визуализируем данные и анализируем зависимости;
- Выводы перечислены в файлах conclusions_eda.md и notebook_eda.ipynb, которые находятся в папке model_improvement.
- Логируем файлы conclusions_eda.md и notebook_eda.ipynb в MLflow, код для логирования
находится в ноутбуке notebook_steps_2_5.ipynb, который находится в папке model_improvement.

Результаты в MLflow:
- EXPERIMENT_NAME = 'mle-project-sprint-2'
- RUN_NAME = 'step_2'

#### Этап 3: Генерация признаков и обучение модели
Укажите, какие признаки были сгенерированы и как это повлияло на модель. Добавьте названия запусков в MLflow для этапа генерации признаков.

#### Этап 4: Отбор признаков и обучение новой версии модели
Опишите процесс отбора признаков, а также назовите запуски в MLflow, связанные с этим этапом.

#### Этап 5: Подбор гиперпараметров и обучение новой версии модели
Опишите использованные методы подбора гиперпараметров, дайте оценку их влияния на результаты модели. Добавьте названия соответствующих запусков в MLflow. 
